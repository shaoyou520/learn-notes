## 验证
``` 
[root@redis-5 redis-7.4.0]# redis-cli -c -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:6379> set pp v234
-> Redirected to slot [14030] located at 10.244.0.129:6379
OK
10.244.0.129:6379> set yy v234
-> Redirected to slot [7551] located at 10.244.3.221:6379
OK
10.244.3.221:6379> 
```
# 异常验证:
```
set mm hello
-> Redirected to slot [125] located at 10.244.2.15:6379
OK
10.244.2.15:6379> set 1 hello
-> Redirected to slot [9842] located at 10.244.3.247:6379
OK
10.244.3.247:6379> set pp hello
-> Redirected to slot [14030] located at 10.244.0.140:6379

127.0.0.1:6379> cluster nodes
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.140:6379@16379 master,fail - 1725113068806 1725113067803 3 connected 10923-16383
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.247:6379@16379 master - 0 1725113153299 2 connected 5461-10922
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.15:6379@16379 master,fail - 1725112879725 1725112877000 7 connected
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.249:6379@16379 slave,fail 36fec7e4143cad48f4aa5b7871f02abdaa2e2410 1725112847541 1725112844000 2 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.227:6379@16379 slave,fail a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 1725112909899 1725112907891 3 connected
127.0.0.1:6379> get mm
(error) CLUSTERDOWN The cluster is down
127.0.0.1:6379> get pp
(error) CLUSTERDOWN The cluster is down
```
#cluster-require-full-coverage no
master 部分slot不够时 也可正常使用
# 全节点
```  
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.228:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725116622130 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.142:6379@16379 master - 0 1725116621124 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.17:6379@16379 slave 1cc8476e3bf4db042aacc24459b188850448c782 0 1725116619000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 slave bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 0 1725116620117 9 connected
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.251:6379@16379 master - 1725116611068 1725116607047 9 disconnected 5461-10922
```
# 删除一个master
``` 
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.228:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725116644000 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.142:6379@16379 master - 0 1725116643246 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.17:6379@16379 slave 1cc8476e3bf4db042aacc24459b188850448c782 0 1725116645256 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master - 0 1725116644252 10 connected 5461-10922
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.251:6379@16379 master,fail - 1725116611068 1725116607047 9 connected
```
# 删除一个slave
``` 
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.228:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725116805141 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.142:6379@16379 master - 0 1725116804135 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.17:6379@16379 slave,fail 1cc8476e3bf4db042aacc24459b188850448c782 1725116730726 1725116724000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master - 0 1725116800110 10 connected 5461-10922
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.251:6379@16379 master,fail - 1725116611068 1725116607047 9 connected
127.0.0.1:6379> get mm
"hello"
127.0.0.1:6379> get 1
-> Redirected to slot [9842] located at 10.244.3.250:6379
"hello"
10.244.3.250:6379> get pp
-> Redirected to slot [14030] located at 10.244.0.142:6379
"hello"
```
# 删除slave 
``` 
10.244.0.142:6379> cluster nodes
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.139:6379@16379 myself,master - 0 0 3 connected 10923-16383
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.228:6379@16379 slave,fail a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 1725117000159 1725116997000 3 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.16:6379@16379 master - 0 1725117095740 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master - 0 1725117094734 10 connected 5461-10922
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.17:6379@16379 slave,fail 1cc8476e3bf4db042aacc24459b188850448c782 1725116725479 1725116722462 8 connected
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.251:6379@16379 master,fail - 1725116609777 1725116607000 9 connected
10.244.0.142:6379> get mm
-> Redirected to slot [125] located at 10.244.2.16:6379
"hello"
10.244.2.16:6379> get pp
-> Redirected to slot [14030] located at 10.244.0.142:6379
"hello"
10.244.0.142:6379> get 1
-> Redirected to slot [9842] located at 10.244.3.250:6379
"hello"
```
# 再删master
``` 
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.228:6379@16379 slave,fail a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 1725117002238 1725116997213 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.142:6379@16379 master,fail - 1725117175192 1725117173000 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.17:6379@16379 slave,fail 1cc8476e3bf4db042aacc24459b188850448c782 1725116730726 1725116724000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master - 0 1725117307931 10 connected 5461-10922
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.251:6379@16379 master,fail - 1725116611068 1725116607047 9 connected
127.0.0.1:6379> get 1
-> Redirected to slot [9842] located at 10.244.3.250:6379
"hello"
10.244.3.250:6379> get mm
-> Redirected to slot [125] located at 10.244.2.16:6379
"hello"
10.244.2.16:6379> get pp
-> Redirected to slot [14030] located at 10.244.0.142:6379
Could not connect to Redis at 10.244.0.142:6379: No route to host
(3.85s)
```

# 恢复6节点
``` 
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.229:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725117565000 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.143:6379@16379 master - 0 1725117565379 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.18:6379@16379 slave 1cc8476e3bf4db042aacc24459b188850448c782 0 1725117566000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master - 0 1725117567390 10 connected 5461-10922
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.252:6379@16379 slave 36fec7e4143cad48f4aa5b7871f02abdaa2e2410 0 1725117568395 10 connected
```
# 删除master
```  
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.229:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725117886131 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.143:6379@16379 master - 0 1725117885000 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.18:6379@16379 slave 1cc8476e3bf4db042aacc24459b188850448c782 0 1725117885000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master,fail - 1725117866524 1725117859000 10 connected
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.252:6379@16379 master - 0 1725117885125 11 connected 5461-10922
```
# 在删除master
``` 
127.0.0.1:6379> cluster nodes
3eb73c00d94cd32aad6be23f052ab284d34e3492 10.244.1.229:6379@16379 slave a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 0 1725118011813 3 connected
a6b1e8805ecee8f4173049cb2ae8fd03b17d1902 10.244.0.143:6379@16379 master - 0 1725118012817 3 connected 10923-16383
081709369aa47b9f889aeed218789d94ccfc8c6e 10.244.2.18:6379@16379 slave 1cc8476e3bf4db042aacc24459b188850448c782 0 1725118010000 8 connected
1cc8476e3bf4db042aacc24459b188850448c782 10.244.2.12:6379@16379 myself,master - 0 0 8 connected 0-5460
36fec7e4143cad48f4aa5b7871f02abdaa2e2410 10.244.3.250:6379@16379 master,fail - 1725117866524 1725117859000 10 connected
bc4106a4b2ef62d58e1dd87cf1167703562d4d8b 10.244.3.252:6379@16379 master,fail - 1725117992709 1725117990000 11 connected 5461-10922
127.0.0.1:6379> k get mm
(error) ERR unknown command 'k', with args beginning with: 'get' 'mm' 
127.0.0.1:6379>  get mm
"hello"
127.0.0.1:6379> get 1
-> Redirected to slot [9842] located at 10.244.3.252:6379
Could not connect to Redis at 10.244.3.252:6379: No route to host
(3.01s)
not connected> 
[root@redis-0 redis-7.4.0]# redis-cli -c -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:6379> get pp
-> Redirected to slot [14030] located at 10.244.0.143:6379
"hello"
10.244.0.143:6379> get mm
-> Redirected to slot [125] located at 10.244.2.16:6379
"hello"
```

# replica-read-only yes
副本可读

主故障, 从-> 主
从故障 不影响
主从都挂, slot挂